C,D
`/**
 * Game 21 - an example in C language for Rosseta Code.
 *
 * A simple game program whose rules are described below
 * - see DESCRIPTION string.
 *
 * This program should be compatible with C89 and up.
 */


/*
 * Turn off MS Visual Studio panic warnings which disable to use old gold
 * library functions like printf, scanf etc. This definition should be harmless
 * for non-MS compilers.
 */
#define _CRT_SECURE_NO_WARNINGS

#include <stdio.h>
#include <stdlib.h>
#include <time.h>

/*
 * Define bool, true and false as needed. The stdbool.h is a standard header
 * in C99, therefore for older compilers we need DIY booleans. BTW, there is
 * no __STDC__VERSION__ predefined macro in MS Visual C, therefore we need
 * check also _MSC_VER.
 */
#if __STDC_VERSION__ >= 199901L || _MSC_VER >= 1800
#include <stdbool.h>
#else
#define bool int
#define true  1
#define false 0
#endif

#define GOAL               21
#define NUMBER_OF_PLAYERS   2
#define MIN_MOVE            1
#define MAX_MOVE            3
#define BUFFER_SIZE       256

#define _(STRING) STRING


/*
 * Spaces are meaningful: on some systems they can be visible.
 */
static char DESCRIPTION[] = ""21 Game 21 is a two player game, the game is played by choosing a number (1, 2, or 3) to be added to the running total. The game is won by the player whose chosen number causes the running total to reach exactly 21. The running total starts at zero."";

static int total;


void update(char* player, int move)
{
    printf(""%8s:  %d = %d + %d\n\n"", player, total + move, total, move);
    total += move;
    if (total == GOAL)
        printf(_(""The winner is %s.\n\n""), player);
}


int ai()
{
/*
 * There is a winning strategy for the first player. The second player can win
 * then and only then the frist player does not use the winning strategy.
 *
 * The winning strategy may be defined as best move for the given running total.
 * The running total is a number from 0 to GOAL. Therefore, for given GOAL, best
 * moves may be precomputed (and stored in a lookup table). Actually (when legal
 * moves are 1 or 2 or 3) the table may be truncated to four first elements.
 */
#if GOAL < 32 && MIN_MOVE == 1 && MAX_MOVE == 3
    static const int precomputed[] = { 1, 1, 3, 2, 1, 1, 3, 2, 1, 1, 3, 2, 1, 1,
        3, 2, 1, 1, 3, 2, 1, 1, 3, 2, 1, 1, 3, 2, 1, 1, 3 };
    update(_(""ai""), precomputed[total]);
#elif MIN_MOVE == 1 && MAX_MOVE == 3
    static const int precomputed[] = { 1, 1, 3, 2};
    update(_(""ai""), precomputed[total % (MAX_MOVE + 1)]);
#else
    int i;
    int move = 1;
    for (i = MIN_MOVE; i <= MAX_MOVE; i++)
        if ((total + i - 1) % (MAX_MOVE + 1) == 0)
            move = i;
    for (i = MIN_MOVE; i <= MAX_MOVE; i++)
        if (total + i == GOAL)
            move = i;
    update(_(""ai""), move);
#endif
}


void human(void)
{
    char buffer[BUFFER_SIZE];
    int move;

    while ( printf(_(""enter your move to play (or enter 0 to exit game): "")),
            fgets(buffer, BUFFER_SIZE, stdin),
            sscanf(buffer, ""%d"", &move) != 1 ||
            (move && (move < MIN_MOVE || move > MAX_MOVE || total+move > GOAL)))
        puts(_(""\nYour answer is not a valid choice.\n""));
    putchar('\n');
    if (!move) exit(EXIT_SUCCESS);
    update(_(""human""), move);
}


int main(int argc, char* argv[])
{
    srand(time(NULL));
    puts(_(DESCRIPTION));
    while (true)
    {
        puts(_(""\n---- NEW GAME ----\n""));
        puts(_(""\nThe running total is currently zero.\n""));
        total = 0;

        if (rand() % NUMBER_OF_PLAYERS)
        {
            puts(_(""The first move is AI move.\n""));
            ai();
        }
        else
            puts(_(""The first move is human move.\n""));

        while (total < GOAL)
        {
            human();
            ai();
        }
    }
}
`,`/* This file was generated by the Hex-Rays decompiler version 8.4.0.240320.
   Copyright (c) 2007-2021 Hex-Rays <infohex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall update(const char *a1, unsigned int a2);
__int64 ai();
__int64 human();
int __fastcall main(int argc, const char **argv, const char **envp);
// void __cdecl __noreturn exit(int);
// char *__cdecl fgets(char *, int, FILE *);
// int printf(const char *, ...);
// int __cdecl putchar(int);
// int __cdecl puts(const char *);
// int rand(void);
// void __cdecl srand(unsigned int);
// int sscanf(const char *, const char *, ...);
// time_t __cdecl time(time_t *);

//-------------------------------------------------------------------------
// Data declarations

_DWORD ai_precomputed[31] =
{
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3
}; // weak
char DESCRIPTION[398] = ""21 Game                                                          \n                                                                 \n21 is a two player game, the game is played by choosing a number \n(1, 2, or 3) to be added to the running total. The game is won by\nthe player whose chosen number causes the running total to reach \nexactly 21. The running total starts at zero.                    \n\n""; // weak
int total; // weak
// extern FILE *__stdinp;


//----- (0000000100003A60) ----------------------------------------------------
__int64 __fastcall update(const char *a1, unsigned int a2)
{
  __int64 result; // x0

  result = printf(""%8s:  %d = %d + %d\n\n"", a1, total + a2, (unsigned int)total, a2);
  total += a2;
  if ( total == 21 )
    return printf(""The winner is %s.\n\n"", a1);
  return result;
}
// 100008190: using guessed type int total;

//----- (0000000100003B10) ----------------------------------------------------
__int64 ai()
{
  unsigned int v1; // [xsp+Ch] [xbp-4h]

  update(""ai"", ai_precomputed[total]);
  return v1;
}
// 100003B3C: variable 'v1' is possibly undefined
// 100003F24: using guessed type _DWORD ai_precomputed[31];
// 100008190: using guessed type int total;

//----- (0000000100003B4C) ----------------------------------------------------
__int64 human()
{
  bool v1; // [xsp+10h] [xbp-130h]
  bool v2; // [xsp+14h] [xbp-12Ch]
  char v3; // [xsp+20h] [xbp-120h]
  signed int v4; // [xsp+24h] [xbp-11Ch] BYREF
  char v5[256]; // [xsp+28h] [xbp-118h] BYREF

  while ( 1 )
  {
    printf(""enter your move to play (or enter 0 to exit game): "");
    fgets(v5, 256, __stdinp);
    v3 = 1;
    if ( sscanf(v5, ""%d"", &v4) == 1 )
    {
      v2 = 0;
      if ( v4 )
      {
        v1 = 1;
        if ( v4 >= 1 )
        {
          v1 = 1;
          if ( v4 <= 3 )
            v1 = total + v4 > 21;
        }
        v2 = v1;
      }
      v3 = v2;
    }
    if ( (v3 & 1) == 0 )
      break;
    puts(""\nYour answer is not a valid choice.\n"");
  }
  putchar(10);
  if ( !v4 )
    exit(0);
  return update(""human"", v4);
}
// 100008190: using guessed type int total;

//----- (0000000100003CDC) ----------------------------------------------------
int __fastcall main(int argc, const char **argv, const char **envp)
{
  unsigned int v3; // w0

  v3 = time(0LL);
  srand(v3);
  puts(DESCRIPTION);
  while ( 1 )
  {
    puts(""\n---- NEW GAME ----\n"");
    puts(""\nThe running total is currently zero.\n"");
    total = 0;
    if ( rand() % 2 )
    {
      puts(""The first move is AI move.\n"");
      ai();
    }
    else
    {
      puts(""The first move is human move.\n"");
    }
    while ( total < 21 )
    {
      human();
      ai();
    }
  }
}
// 100008190: using guessed type int total;

// nfuncs=14 queued=4 decompiled=4 lumina nreq=0 worse=0 better=0
// ALL OK, 4 function(s) have been successfully decompiled`
`/**
 * Game 21 - an example in C language for Rosseta Code.
 *
 * A simple game program whose rules are described below
 * - see DESCRIPTION string.
 *
 * This program should be compatible with C89 and up.
 */


/*
 * Turn off MS Visual Studio panic warnings which disable to use old gold
 * library functions like printf, scanf etc. This definition should be harmless
 * for non-MS compilers.
 */
#define _CRT_SECURE_NO_WARNINGS

#include <stdio.h>
#include <stdlib.h>
#include <time.h>

/*
 * Define bool, true and false as needed. The stdbool.h is a standard header
 * in C99, therefore for older compilers we need DIY booleans. BTW, there is
 * no __STDC__VERSION__ predefined macro in MS Visual C, therefore we need
 * check also _MSC_VER.
 */
#if __STDC_VERSION__ >= 199901L || _MSC_VER >= 1800
#include <stdbool.h>
#else
#define bool int
#define true  1
#define false 0
#endif

#define GOAL               21
#define NUMBER_OF_PLAYERS   2
#define MIN_MOVE            1
#define MAX_MOVE            3
#define BUFFER_SIZE       256

#define _(STRING) STRING


/*
 * Spaces are meaningful: on some systems they can be visible.
 */
static char DESCRIPTION[] = ""21 Game 21 is a two player game, the game is played by choosing a number (1, 2, or 3) to be added to the running total. The game is won by the player whose chosen number causes the running total to reach exactly 21. The running total starts at zero."";

static int total;


void update(char* player, int move)
{
    printf(""%8s:  %d = %d + %d\n\n"", player, total + move, total, move);
    total += move;
    if (total == GOAL)
        printf(_(""The winner is %s.\n\n""), player);
}


int ai()
{
/*
 * There is a winning strategy for the first player. The second player can win
 * then and only then the frist player does not use the winning strategy.
 *
 * The winning strategy may be defined as best move for the given running total.
 * The running total is a number from 0 to GOAL. Therefore, for given GOAL, best
 * moves may be precomputed (and stored in a lookup table). Actually (when legal
 * moves are 1 or 2 or 3) the table may be truncated to four first elements.
 */
#if GOAL < 32 && MIN_MOVE == 1 && MAX_MOVE == 3
    static const int precomputed[] = { 1, 1, 3, 2, 1, 1, 3, 2, 1, 1, 3, 2, 1, 1,
        3, 2, 1, 1, 3, 2, 1, 1, 3, 2, 1, 1, 3, 2, 1, 1, 3 };
    update(_(""ai""), precomputed[total]);
#elif MIN_MOVE == 1 && MAX_MOVE == 3
    static const int precomputed[] = { 1, 1, 3, 2};
    update(_(""ai""), precomputed[total % (MAX_MOVE + 1)]);
#else
    int i;
    int move = 1;
    for (i = MIN_MOVE; i <= MAX_MOVE; i++)
        if ((total + i - 1) % (MAX_MOVE + 1) == 0)
            move = i;
    for (i = MIN_MOVE; i <= MAX_MOVE; i++)
        if (total + i == GOAL)
            move = i;
    update(_(""ai""), move);
#endif
}


void human(void)
{
    char buffer[BUFFER_SIZE];
    int move;

    while ( printf(_(""enter your move to play (or enter 0 to exit game): "")),
            fgets(buffer, BUFFER_SIZE, stdin),
            sscanf(buffer, ""%d"", &move) != 1 ||
            (move && (move < MIN_MOVE || move > MAX_MOVE || total+move > GOAL)))
        puts(_(""\nYour answer is not a valid choice.\n""));
    putchar('\n');
    if (!move) exit(EXIT_SUCCESS);
    update(_(""human""), move);
}


int main(int argc, char* argv[])
{
    srand(time(NULL));
    puts(_(DESCRIPTION));
    while (true)
    {
        puts(_(""\n---- NEW GAME ----\n""));
        puts(_(""\nThe running total is currently zero.\n""));
        total = 0;

        if (rand() % NUMBER_OF_PLAYERS)
        {
            puts(_(""The first move is AI move.\n""));
            ai();
        }
        else
            puts(_(""The first move is human move.\n""));

        while (total < GOAL)
        {
            human();
            ai();
        }
    }
}
`,`/* This file was generated by the Hex-Rays decompiler version 8.4.0.240320.
   Copyright (c) 2007-2021 Hex-Rays <infohex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall update(const char *a1, unsigned int a2);
__int64 ai();
__int64 human();
int __fastcall main(int argc, const char **argv, const char **envp);
// void __cdecl __noreturn exit(int);
// char *__cdecl fgets(char *, int, FILE *);
// int printf(const char *, ...);
// int __cdecl putchar(int);
// int __cdecl puts(const char *);
// int rand(void);
// void __cdecl srand(unsigned int);
// int sscanf(const char *, const char *, ...);
// time_t __cdecl time(time_t *);

//-------------------------------------------------------------------------
// Data declarations

_DWORD ai_precomputed[31] =
{
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3,
  2,
  1,
  1,
  3
}; // weak
char DESCRIPTION[398] = ""21 Game                                                          \n                                                                 \n21 is a two player game, the game is played by choosing a number \n(1, 2, or 3) to be added to the running total. The game is won by\nthe player whose chosen number causes the running total to reach \nexactly 21. The running total starts at zero.                    \n\n""; // weak
int total; // weak
// extern FILE *__stdinp;


//----- (0000000100003A60) ----------------------------------------------------
__int64 __fastcall update(const char *a1, unsigned int a2)
{
  __int64 result; // x0

  result = printf(""%8s:  %d = %d + %d\n\n"", a1, total + a2, (unsigned int)total, a2);
  total += a2;
  if ( total == 21 )
    return printf(""The winner is %s.\n\n"", a1);
  return result;
}
// 100008190: using guessed type int total;

//----- (0000000100003B10) ----------------------------------------------------
__int64 ai()
{
  unsigned int v1; // [xsp+Ch] [xbp-4h]

  update(""ai"", ai_precomputed[total]);
  return v1;
}
// 100003B3C: variable 'v1' is possibly undefined
// 100003F24: using guessed type _DWORD ai_precomputed[31];
// 100008190: using guessed type int total;

//----- (0000000100003B4C) ----------------------------------------------------
__int64 human()
{
  bool v1; // [xsp+10h] [xbp-130h]
  bool v2; // [xsp+14h] [xbp-12Ch]
  char v3; // [xsp+20h] [xbp-120h]
  signed int v4; // [xsp+24h] [xbp-11Ch] BYREF
  char v5[256]; // [xsp+28h] [xbp-118h] BYREF

  while ( 1 )
  {
    printf(""enter your move to play (or enter 0 to exit game): "");
    fgets(v5, 256, __stdinp);
    v3 = 1;
    if ( sscanf(v5, ""%d"", &v4) == 1 )
    {
      v2 = 0;
      if ( v4 )
      {
        v1 = 1;
        if ( v4 >= 1 )
        {
          v1 = 1;
          if ( v4 <= 3 )
            v1 = total + v4 > 21;
        }
        v2 = v1;
      }
      v3 = v2;
    }
    if ( (v3 & 1) == 0 )
      break;
    puts(""\nYour answer is not a valid choice.\n"");
  }
  putchar(10);
  if ( !v4 )
    exit(0);
  return update(""human"", v4);
}
// 100008190: using guessed type int total;

//----- (0000000100003CDC) ----------------------------------------------------
int __fastcall main(int argc, const char **argv, const char **envp)
{
  unsigned int v3; // w0

  v3 = time(0LL);
  srand(v3);
  puts(DESCRIPTION);
  while ( 1 )
  {
    puts(""\n---- NEW GAME ----\n"");
    puts(""\nThe running total is currently zero.\n"");
    total = 0;
    if ( rand() % 2 )
    {
      puts(""The first move is AI move.\n"");
      ai();
    }
    else
    {
      puts(""The first move is human move.\n"");
    }
    while ( total < 21 )
    {
      human();
      ai();
    }
  }
}
// 100008190: using guessed type int total;

// nfuncs=14 queued=4 decompiled=4 lumina nreq=0 worse=0 better=0
// ALL OK, 4 function(s) have been successfully decompiled`