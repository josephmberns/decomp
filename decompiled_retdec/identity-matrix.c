//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdint.h>
#include <stdlib.h>
#include <unistd.h>

// ------------------- Function Prototypes --------------------

int64_t entry_point(void);
void function_100003ea8(void);
int32_t function_100003eb4(char * nptr);
int64_t * function_100003ec0(int32_t nmemb, int32_t size);
void function_100003ecc(int32_t status);
int32_t function_100003ed8(char * format, ...);

// ------- Dynamically Linked Functions Without Header --------

void _abort(void);
int32_t _atoi(char * a1);
int64_t * _calloc(int32_t a1, int32_t a2);
int32_t _printf(char * a1, ...);

// ------------------------ Functions -------------------------

// Address range: 0x100003c28 - 0x100003ea8
int64_t entry_point(void) {
    // 0x100003c28
    int64_t v1; // 0x100003c28
    int32_t v2 = v1; // 0x100003c38
    if (v2 < 2 != (1 - v2 & v2) < 0) {
        // 0x100003c54
        _printf("usage: identitymatrix <number of rows>\n");
        _exit(1);
        // UNREACHABLE
    }
    int32_t v3 = _atoi((char *)*(int64_t *)(v1 + 8)); // 0x100003c70
    if (v3 < 0) {
        // 0x100003c8c
        _printf("Dimensions of matrix cannot be negative\n");
        _exit(1);
        // UNREACHABLE
    }
    int32_t v4 = v3 * v3; // 0x100003ca8
    int32_t v5 = v4 - v3; // 0x100003cb8
    if (v5 < 0 != ((v5 ^ v4) & (v4 ^ v3)) < 0) {
        // 0x100003cc8
        _printf("Squaring %d caused result to overflow to %d.\n", v1, v1);
        _abort();
    }
    int64_t * v6 = _calloc(v4, 8); // 0x100003cfc
    if (v6 == NULL) {
        // 0x100003d18
        _printf("Failed to allocate %d elements of %ld bytes each\n", 8, (int32_t)v1);
        _abort();
    }
    if (v3 == 0) {
        // 0x100003dec
        _printf("Matrix is: \n");
        // 0x100003e98
        return 0;
    }
    int64_t v7 = 0;
    int64_t * v8 = _calloc(v4, 4); // 0x100003d68
    int64_t v9 = (int64_t)v8; // 0x100003d68
    int64_t * v10 = (int64_t *)(8 * v7 + (int64_t)v6); // 0x100003d74
    *v10 = v9;
    int64_t v11 = v9; // 0x100003d8c
    if (v8 == NULL) {
        // 0x100003d94
        _printf("Failed to allocate %d elements of %ld bytes each\n", 4, (int32_t)v1);
        _abort();
        v11 = *v10;
    }
    // 0x100003dbc
    *(int32_t *)(v11 + 4 * v7) = 1;
    v7++;
    while (v7 != (int64_t)v3) {
        // 0x100003d60
        v8 = _calloc(v4, 4);
        v9 = (int64_t)v8;
        v10 = (int64_t *)(8 * v7 + (int64_t)v6);
        *v10 = v9;
        v11 = v9;
        if (v8 == NULL) {
            // 0x100003d94
            _printf("Failed to allocate %d elements of %ld bytes each\n", 4, (int32_t)v1);
            _abort();
            v11 = *v10;
        }
        // 0x100003dbc
        *(int32_t *)(v11 + 4 * v7) = 1;
        v7++;
    }
    // 0x100003dec
    _printf("Matrix is: \n");
    int32_t v12 = 0; // 0x100003e8c
    int32_t v13 = 0; // 0x100003e6c
    _printf("%d ", 4);
    while (v13 + 1 != v3) {
        // 0x100003e38
        v13++;
        _printf("%d ", 4);
    }
    // 0x100003e78
    _printf((char *)0x100003fa6);
    while (v12 + 1 != v3) {
        // 0x100003e38
        v12++;
        v13 = 0;
        _printf("%d ", 4);
        while (v13 + 1 != v3) {
            // 0x100003e38
            v13++;
            _printf("%d ", 4);
        }
        // 0x100003e78
        _printf((char *)0x100003fa6);
    }
    // 0x100003e98
    return 0;
}

// Address range: 0x100003ea8 - 0x100003eb4
void function_100003ea8(void) {
    // 0x100003ea8
    _abort();
}

// Address range: 0x100003eb4 - 0x100003ec0
int32_t function_100003eb4(char * nptr) {
    // 0x100003eb4
    return _atoi(nptr);
}

// Address range: 0x100003ec0 - 0x100003ecc
int64_t * function_100003ec0(int32_t nmemb, int32_t size) {
    // 0x100003ec0
    return _calloc(nmemb, size);
}

// Address range: 0x100003ecc - 0x100003ed8
void function_100003ecc(int32_t status) {
    // 0x100003ecc
    _exit(status);
}

// Address range: 0x100003ed8 - 0x100003ee4
int32_t function_100003ed8(char * format, ...) {
    // 0x100003ed8
    return _printf(format);
}

// --------------------- Meta-Information ---------------------

// Detected functions: 6

