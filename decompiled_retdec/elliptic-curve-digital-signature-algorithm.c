//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdint.h>
#include <stdlib.h>

// ---------------- Integer Types Definitions -----------------

typedef int64_t int128_t;

// ----------------- Float Types Definitions ------------------

typedef double float64_t;
typedef long double float128_t;

// ------------------- Function Prototypes --------------------

int64_t entry_point(void);
int64_t function_100002a80(void);
int64_t function_100002b94(void);
int64_t function_100002bf8(void);
int64_t function_100002c8c(void);
int64_t function_100002cf0(void);
int64_t function_100002d40(void);
int64_t function_100002df0(void);
int64_t function_100003010(void);
int64_t function_100003100(void);
int64_t function_1000031d4(void);
int64_t function_10000338c(int64_t a1);
int64_t function_1000033b0(void);
int64_t function_1000034f0(void);
int64_t function_10000373c(void);
int64_t function_100003b88(int64_t a1);
int64_t * function_100003b94(int64_t * dest, int64_t * src, int32_t n);
int32_t function_100003ba0(char * format, ...);
int32_t function_100003bac(void);
void function_100003bb8(int32_t seed);
int32_t function_100003bc4(int32_t * timer);

// --------------------- Global Variables ---------------------

int64_t g1 = 355; // 0x100003bf0
int64_t g2 = 0x100000cfeedfacf; // 0x100008000
int64_t g3 = 0x200000000; // 0x100008008
int64_t g4 = 0x50800000012; // 0x100008010
int64_t g5 = 0x200085; // 0x100008018
int64_t g6 = 0x4800000019; // 0x100008020
char g7[11] = "__PAGEZERO"; // 0x100008028
char g8[3] = "RO"; // 0x100008030
float128_t g9 = 0.0L; // 0x100008038
int64_t g10 = 0x100000000; // 0x100008040
int32_t g11;

// ------- Dynamically Linked Functions Without Header --------

int64_t ___stack_chk_fail(int64_t a1);
int64_t * _memcpy(int64_t * a1, int64_t * a2, int32_t a3);
int32_t _printf(char * a1, ...);
int32_t _rand(void);
void _srand(int32_t a1);
int32_t _time(int32_t * a1);

// ------------------------ Functions -------------------------

// Address range: 0x100002a80 - 0x100002b94
int64_t function_100002a80(void) {
    // 0x100002a80
    int64_t v1; // 0x100002a80
    int64_t v2 = v1;
    int64_t v3 = (v2 < 0 ? v1 : 0) + v2;
    int64_t result = 0; // 0x100002ad8
    int64_t v4; // 0x100002a80
    if (v3 != 0) {
        int64_t v5 = 1;
        int64_t v6; // 0x100002a80
        int64_t v7 = v6 / v3; // 0x100002ae8
        int64_t v8 = v6 - v7 * v3; // 0x100002b00
        v6 = v3;
        int64_t v9 = -((v7 * v5)); // 0x100002ad8
        result = v5;
        v4 = v3;
        while (v8 != 0) {
            int64_t v10 = v5;
            v5 = v9;
            int64_t v11 = v8;
            v7 = v6 / v11;
            v8 = v6 - v7 * v11;
            v6 = v11;
            v9 = v10 - v7 * v5;
            result = v5;
            v4 = v11;
        }
    }
    // 0x100002b44
    if (v4 != 1) {
        // 0x100002b58
        _printf(" impossible inverse mod N, gcd = %d\n", v1);
        *(int32_t *)&g8 = 1;
    }
    // 0x100002b84
    return result;
}

// Address range: 0x100002b94 - 0x100002bf8
int64_t function_100002b94(void) {
    int64_t v1 = *(int64_t *)&g7; // 0x100002ba4
    int64_t v2; // 0x100002b94
    int64_t v3 = v2 % v1;
    return (v3 < 0 ? v1 : 0) + v3;
}

// Address range: 0x100002bf8 - 0x100002c8c
int64_t function_100002bf8(void) {
    // 0x100002bf8
    function_100002c8c();
    function_100002c8c();
    function_100002c8c();
    return function_100002c8c();
}

// Address range: 0x100002c8c - 0x100002cf0
int64_t function_100002c8c(void) {
    // 0x100002c8c
    int64_t v1; // 0x100002c8c
    int64_t v2 = v1 % g4;
    return (v2 < 0 ? g4 : 0) + v2;
}

// Address range: 0x100002cf0 - 0x100002d40
int64_t function_100002cf0(void) {
    // 0x100002cf0
    int64_t v1; // 0x100002cf0
    return v1 == 0 == v1 == -0x7fffffff;
}

// Address range: 0x100002d40 - 0x100002df0
int64_t function_100002d40(void) {
    // 0x100002d40
    int64_t v1; // 0x100002d40
    int64_t v2; // 0x100002d40
    if ((int32_t)function_100002cf0() == 0) {
        // 0x100002d70
        function_100002c8c();
        v1 = function_100002c8c();
        v2 = function_100002c8c();
    }
    // 0x100002dd0
    return v1 == v2;
}

// Address range: 0x100002df0 - 0x100003010
int64_t function_100002df0(void) {
    // 0x100002df0
    int64_t v1; // 0x100002df0
    int64_t v2 = v1;
    float128_t * v3 = (float128_t *)v1; // 0x100002e0c
    int64_t result = function_100002cf0(); // 0x100002e18
    if ((int32_t)result != 0) {
        // 0x100002e2c
        *v3 = (float128_t)(int128_t)v1;
        // 0x100003004
        return result;
    }
    int64_t result2 = function_100002cf0(); // 0x100002e44
    if ((int32_t)result2 != 0) {
        // 0x100002e58
        *v3 = (float128_t)(int128_t)v1;
        // 0x100003004
        return result2;
    }
    if ((int64_t)(float64_t)(float128_t)(int128_t)v1 == (int64_t)(float64_t)(float128_t)(int128_t)v1) {
        if (v2 != v1 || v2 == 0) {
            // 0x100002f5c
            *v3 = g9;
            // 0x100003004
            return result2;
        }
        // 0x100002ef4
        function_100002c8c();
        function_100002c8c();
        function_100002a80();
        function_100002c8c();
    } else {
        // 0x100002e80
        function_100002a80();
        function_100002c8c();
    }
    int64_t v4 = function_100002c8c(); // 0x100002f94
    int64_t result3 = function_100002c8c(); // 0x100002fb8
    *(int64_t *)(v1 + 8) = result3;
    *(int64_t *)v1 = v4;
    if (*(int32_t *)&g8 != 0) {
        // 0x100002fec
        *v3 = g9;
    }
    // 0x100003004
    return result3;
}

// Address range: 0x100003010 - 0x100003100
int64_t function_100003010(void) {
    // 0x100003010
    int64_t v1; // 0x100003010
    int64_t result; // 0x100003010
    if (v1 == 0) {
        // 0x1000030e8
        *(float128_t *)v1 = g9;
        return result;
    }
    int64_t v2; // 0x100003010
    int64_t result2 = v2; // 0x100003068
    int64_t v3; // 0x100003010
    if (v3 % 2 != 0) {
        // 0x100003070
        result2 = function_100002df0();
    }
    while (*(int32_t *)&g8 == 0) {
        int64_t v4 = function_100002df0(); // 0x1000030d0
        int64_t v5 = v3 >> 1; // 0x1000030dc
        v3 = v5;
        result = v4;
        if (v5 == 0) {
            // 0x1000030e8
            *(float128_t *)v1 = g9;
            return result;
        }
        result2 = v4;
        if (v3 % 2 != 0) {
            // 0x100003070
            result2 = function_100002df0();
        }
    }
    // 0x1000030e8
    *(float128_t *)v1 = g9;
    return result2;
}

// Address range: 0x100003100 - 0x1000031d4
int64_t function_100003100(void) {
    // 0x100003100
    int64_t v1; // 0x100003100
    char * v2 = (char *)v1;
    int32_t result; // 0x100003100
    if ((int32_t)function_100002cf0() == 0) {
        // 0x100003158
        result = _printf("%s (%lld, %lld)\n", v2, v1, v1);
    } else {
        // 0x10000313c
        result = _printf("%s (0)\n", v2);
    }
    // 0x1000031c8
    return result;
}

// Address range: 0x1000031d4 - 0x10000338c
int64_t function_1000031d4(void) {
    // 0x1000031d4
    int64_t v1; // 0x1000031d4
    int64_t v2 = *(int64_t *)(v1 + 16); // 0x100003208
    g4 = v2;
    *(int32_t *)&g8 = 0;
    if (v2 < 5 != (4 - v2 & v2) < 0) {
        // 0x10000337c
        return 0;
    }
    int64_t v3 = v2 - 0x3fffffdd; // 0x100003244
    if (v3 != 0 && v3 < 0 == (0x3fffffdc - v2 & v2) < 0) {
        // 0x10000337c
        return 0;
    }
    // 0x10000325c
    g2 = function_100002c8c();
    g3 = function_100002c8c();
    g5 = function_100002c8c();
    g6 = function_100002c8c();
    int64_t v4 = *(int64_t *)(v1 + 40); // 0x1000032b0
    *(int64_t *)&g7 = v4;
    if (v4 < 5 != (4 - v4 & v4) < 0) {
        // 0x10000337c
        return 0;
    }
    int64_t v5 = v4 - 0x4000ffdd; // 0x1000032e0
    int64_t result = 0; // 0x1000032e8
    if (v5 == 0 || v5 < 0 != (0x4000ffdc - v4 & v4) < 0) {
        // 0x1000032f8
        _printf("\nE: y^2 = x^3 + %dx + %d", v1, v1);
        _printf(" (mod %lld)\n", v1);
        function_100003100();
        _printf("order(G, E) = %lld\n", g5);
        result = 1;
    }
    // 0x10000337c
    return result;
}

// Address range: 0x10000338c - 0x1000033b0
int64_t function_10000338c(int64_t a1) {
    // 0x10000338c
    return _rand();
}

// Address range: 0x1000033b0 - 0x1000034f0
int64_t function_1000033b0(void) {
    // 0x1000033b0
    _printf("\nsignature computation\n");
    function_10000338c((int64_t)&g11);
    function_100003010();
    int64_t result = function_100002b94(); // 0x100003418
    while (result == 0) {
        // 0x1000033d8
        function_10000338c((int64_t)&g11);
        function_100003010();
        result = function_100002b94();
    }
    // 0x100003438
    function_100002a80();
    function_100002b94();
    while (function_100002b94() == 0) {
        function_10000338c((int64_t)&g11);
        function_100003010();
        result = function_100002b94();
        while (result == 0) {
            // 0x1000033d8
            function_10000338c((int64_t)&g11);
            function_100003010();
            result = function_100002b94();
        }
        // 0x100003438
        function_100002a80();
        function_100002b94();
    }
    // 0x1000034a0
    _printf("one-time u = %d\n", *(int64_t *)&g7);
    function_100003100();
    return result;
}

// Address range: 0x1000034f0 - 0x10000373c
int64_t function_1000034f0(void) {
    // 0x1000034f0
    int64_t v1; // 0x1000034f0
    uint64_t v2 = v1;
    uint64_t v3 = v1;
    int64_t v4 = 0; // 0x100003534
    if (v3 >= 1) {
        int64_t v5 = *(int64_t *)&g7; // 0x100003548
        int64_t v6 = v3 - v5; // 0x10000354c
        v4 = v6 < 0 != ((v6 ^ v3) & (v5 ^ v3)) < 0;
    }
    int64_t v7 = 0; // 0x10000357c
    if (v2 >= 1) {
        int64_t v8 = *(int64_t *)&g7; // 0x100003590
        int64_t v9 = v2 - v8; // 0x100003594
        v7 = v9 < 0 != ((v9 ^ v2) & (v8 ^ v2)) < 0;
    }
    // 0x1000035a4
    if ((v7 & v4) == 0) {
        // 0x10000372c
        return 0;
    }
    // 0x1000035d4
    _printf("\nsignature verification\n");
    function_100002a80();
    function_100002b94();
    function_100002b94();
    _printf("h1,h2 = %d, %d\n", *(int64_t *)&g7, v1);
    function_100003010();
    function_100003010();
    function_100003100();
    function_100003100();
    function_100002df0();
    function_100003100();
    int64_t result = 0; // 0x1000036dc
    if ((int32_t)function_100002cf0() == 0) {
        int64_t v10 = function_100002b94(); // 0x1000036f0
        _printf("c' = %d\n", v1);
        result = v10 == v3;
    }
    // 0x10000372c
    return result;
}

// Address range: 0x10000373c - 0x100003aa0
int64_t function_10000373c(void) {
    int64_t v1 = function_100002bf8(); // 0x100003750
    int64_t v2 = function_100002cf0(); // 0x10000377c
    function_100003010();
    int64_t v3 = function_100002cf0(); // 0x1000037b4
    if ((0x100000000 * v2 >> 32 | (int64_t)(v1 == 0) | (int64_t)((int32_t)v3 == 0) | (int64_t)((int32_t)function_100002d40() == 0)) != 0) {
        // 0x100003a78
        _printf("invalid parameter set\n");
        // 0x100003a94
        return _printf("_____________________\n");
    }
    // 0x100003818
    _printf("\nkey generation\n");
    function_10000338c((int64_t)&g11);
    function_100003010();
    _printf("private key s = %d\n", g5);
    function_100003100();
    int64_t v4 = 1; // 0x1000038e4
    int64_t v5 = *(int64_t *)&g7;
    int64_t v6 = v5 >> v4 | v5; // 0x1000038d4
    v4 *= 2;
    while (v4 < 32 != (31 - v4 & v4) < 0) {
        // 0x1000038c4
        v5 = v6;
        v6 = v5 >> v4 | v5;
        v4 *= 2;
    }
    int64_t v7; // 0x10000373c
    int32_t v8 = v7;
    int64_t v9 = v8; // 0x1000038f4
    int64_t v10 = v9 - v6; // 0x1000038fc
    int32_t v11 = v8 >> 1; // 0x100003904
    while (v10 != 0 && v10 < 0 == ((v10 ^ v9) & (v6 ^ v9)) < 0) {
        // 0x1000038f4
        v8 = v11;
        v9 = v8;
        v10 = v9 - v6;
        v11 = v8 >> 1;
    }
    // 0x10000391c
    int32_t v12; // 0x10000373c
    _printf("\naligned hash %x\n", v12);
    function_1000033b0();
    if (*(int32_t *)&g8 != 0) {
        // 0x100003a78
        _printf("invalid parameter set\n");
        // 0x100003a94
        return _printf("_____________________\n");
    }
    // 0x100003970
    _printf("signature c,d = %d, %d\n", v9, v7);
    if ((uint64_t)v7 >= 1) {
        int64_t v13; // 0x10000373c
        int64_t v14 = v13;
        int64_t v15 = v14 - v6; // 0x1000039b0
        v13 = v14 >> 1;
        while (v15 != 0 && v15 < 0 == ((v15 ^ v14) & (v14 ^ v6)) < 0) {
            // 0x1000039a8
            v14 = v13;
            v15 = v14 - v6;
            v13 = v14 >> 1;
        }
        // 0x1000039d0
        _printf("\ncorrupted hash %x\n", v8);
    }
    int64_t v16 = function_1000034f0(); // 0x100003a10
    if (*(int32_t *)&g8 != 0) {
        // 0x100003a78
        _printf("invalid parameter set\n");
        // 0x100003a94
        return _printf("_____________________\n");
    }
    if ((v16 & 0xffffffff) == 0) {
        // 0x100003a94
        return _printf("invalid\n_______\n");
    }
    // 0x100003a94
    return _printf("Valid\n_____\n");
}

// Address range: 0x100003aa0 - 0x100003b88
int64_t entry_point(void) {
    // 0x100003aa0
    *(int64_t *)&g9 = -0x7fffffff;
    g10 = 0;
    _srand(_time(NULL));
    int64_t v1; // bp-512, 0x100003aa0
    _memcpy(&v1, &g1, 480);
    int64_t v2 = function_1000031d4(); // 0x100003b18
    int64_t v3 = v2; // 0x100003b24
    if ((int32_t)v2 != 0) {
        function_10000373c();
        int64_t v4 = function_1000031d4(); // 0x100003b18
        v3 = v4;
        while ((int32_t)v4 != 0) {
            // 0x100003b2c
            function_10000373c();
            v4 = function_1000031d4();
            v3 = v4;
        }
    }
    int64_t v5 = *(int64_t *)*(int64_t *)0x100004008; // 0x100003b60
    int64_t result = v3; // 0x100003b6c
    if (v5 != *(int64_t *)*(int64_t *)0x100004008) {
        // 0x100003b74
        result = ___stack_chk_fail(v3);
    }
    // 0x100003b78
    return result;
}

// Address range: 0x100003b88 - 0x100003b94
int64_t function_100003b88(int64_t a1) {
    // 0x100003b88
    return ___stack_chk_fail(a1);
}

// Address range: 0x100003b94 - 0x100003ba0
int64_t * function_100003b94(int64_t * dest, int64_t * src, int32_t n) {
    // 0x100003b94
    return _memcpy(dest, src, n);
}

// Address range: 0x100003ba0 - 0x100003bac
int32_t function_100003ba0(char * format, ...) {
    // 0x100003ba0
    return _printf(format);
}

// Address range: 0x100003bac - 0x100003bb8
int32_t function_100003bac(void) {
    // 0x100003bac
    return _rand();
}

// Address range: 0x100003bb8 - 0x100003bc4
void function_100003bb8(int32_t seed) {
    // 0x100003bb8
    _srand(seed);
}

// Address range: 0x100003bc4 - 0x100003bd0
int32_t function_100003bc4(int32_t * timer) {
    // 0x100003bc4
    return _time(timer);
}

// --------------------- Meta-Information ---------------------

// Detected functions: 21

