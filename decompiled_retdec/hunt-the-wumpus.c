//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>

// ------------------- Function Prototypes --------------------

int64_t entry_point(void);
int64_t function_100003678(void);
int64_t function_100003840(void);
int64_t function_100003978(void);
int64_t function_100003a2c(void);
int32_t function_100003d00(char * format, ...);
int32_t function_100003d0c(void);
int32_t function_100003d18(char * format, ...);
void function_100003d24(int32_t seed);
int32_t function_100003d30(int32_t * timer);

// --------------------- Global Variables ---------------------

int64_t g1 = 0x100000cfeedfacf; // 0x100008000

// ------- Dynamically Linked Functions Without Header --------

int32_t _printf(char * a1, ...);
int32_t _rand(void);
int32_t _scanf(char * a1, ...);
void _srand(int32_t a1);
int32_t _time(int32_t * a1);

// ------------------------ Functions -------------------------

// Address range: 0x100003678 - 0x100003840
int64_t function_100003678(void) {
    int32_t v1 = 1;
    int64_t v2 = 24 * (int64_t)v1;
    int64_t v3 = v2 + (int64_t)&g1; // 0x1000036f4
    int64_t v4 = 0;
    *(int32_t *)(v3 + 4 * v4) = (v1 + (int32_t)v4) % 20 + 1;
    int64_t v5 = v4 + 1;
    while (v5 != 3) {
        // 0x1000036c0
        v4 = v5;
        *(int32_t *)(v3 + 4 * v4) = (v1 + (int32_t)v4) % 20 + 1;
        v5 = v4 + 1;
    }
    // 0x100003714
    *(int32_t *)(v2 + (int64_t)&g1 + 12) = 0;
    *(int32_t *)(v2 + (int64_t)&g1 + 16) = 0;
    *(int32_t *)(v2 + (int64_t)&g1 + 20) = 0;
    int32_t v6 = v1 + 1; // 0x100003760
    while (v1 == 19 || v1 < 19 != (18 - v1 & v6) < 0) {
        // 0x1000036ac
        v1 = v6;
        v2 = 24 * (int64_t)v1;
        v3 = v2 + (int64_t)&g1;
        v4 = 0;
        *(int32_t *)(v3 + 4 * v4) = (v1 + (int32_t)v4) % 20 + 1;
        v5 = v4 + 1;
        while (v5 != 3) {
            // 0x1000036c0
            v4 = v5;
            *(int32_t *)(v3 + 4 * v4) = (v1 + (int32_t)v4) % 20 + 1;
            v5 = v4 + 1;
        }
        // 0x100003714
        *(int32_t *)(v2 + (int64_t)&g1 + 12) = 0;
        *(int32_t *)(v2 + (int64_t)&g1 + 16) = 0;
        *(int32_t *)(v2 + (int64_t)&g1 + 20) = 0;
        v6 = v1 + 1;
    }
    int32_t v7 = _rand(); // 0x10000376c
    *(int32_t *)((int64_t)(24 * (v7 % 20) + 24) + (int64_t)&g1 + 12) = 1;
    int32_t result; // 0x1000037f4
    for (int32_t i = 0; i < 2; i++) {
        int32_t v8 = _rand(); // 0x1000037b8
        *(int32_t *)((int64_t)(24 * (v8 % 20) + 24) + (int64_t)&g1 + 16) = 1;
        result = _rand();
        *(int32_t *)((int64_t)(24 * (result % 20) + 24) + (int64_t)&g1 + 20) = 1;
    }
    // 0x100003834
    return result;
}

// Address range: 0x100003840 - 0x100003978
int64_t function_100003840(void) {
    // 0x100003840
    int64_t v1; // 0x100003840
    int32_t v2 = _printf("You are in room %d.\n", v1); // 0x100003868
    int64_t v3 = 24 * (0x100000000 * v1 >> 32) + (int64_t)&g1; // 0x1000038a0
    int64_t result = v2;
    for (int64_t i = 0; i < 3; i++) {
        int64_t v4 = 24 * (int64_t)*(int32_t *)(v3 + 4 * i); // 0x1000038b4
        int64_t v5 = result; // 0x1000038c8
        if (*(int32_t *)(v4 + (int64_t)&g1 + 12) != 0) {
            // 0x1000038d0
            v5 = _printf("You smell something terrible nearby.\n");
        }
        int64_t v6 = v5; // 0x100003904
        if (*(int32_t *)(v4 + (int64_t)&g1 + 16) != 0) {
            // 0x10000390c
            v6 = _printf("You hear a rustling.\n");
        }
        int64_t v7 = v6; // 0x100003940
        if (*(int32_t *)(v4 + (int64_t)&g1 + 20) != 0) {
            // 0x100003948
            v7 = _printf("You feel a cold wind blowing from a nearby cavern.\n");
        }
        // 0x10000395c
        result = v7;
    }
    // 0x10000396c
    return result;
}

// Address range: 0x100003978 - 0x100003a2c
int64_t function_100003978(void) {
    // 0x100003978
    int32_t v1; // 0x100003978
    int32_t v2 = v1;
    _printf("Choose an adjacent room to move into: ");
    int64_t v3; // 0x100003978
    int32_t v4 = _scanf("%d", (int64_t *)v3); // 0x1000039a8
    if (v2 < 1 != (v2 & -v2) < 0) {
        // 0x1000039d4
        _printf("Invalid choice. Please choose a number between 1 and 3.\n");
        // 0x100003a20
        return function_100003978();
    }
    int32_t v5 = v2 - 3; // 0x1000039c4
    if (v5 == 0 || v5 < 0 != (2 - v2 & v2) < 0) {
        int64_t result = v4;
        int32_t v6 = *(int32_t *)((int64_t)(4 * v2 - 4) + (int64_t)&g1 + 24 * result); // 0x100003a10
        *(int32_t *)v3 = v6;
        // 0x100003a20
        return result;
    }
    // 0x1000039d4
    _printf("Invalid choice. Please choose a number between 1 and 3.\n");
    // 0x100003a20
    return function_100003978();
}

// Address range: 0x100003a2c - 0x100003bb8
int64_t function_100003a2c(void) {
    // 0x100003a2c
    int64_t v1; // 0x100003a2c
    int64_t v2 = v1;
    int32_t v3; // 0x100003a2c
    int32_t v4 = v3;
    _printf("Choose an adjacent room to shoot into: ");
    _scanf("%d", (int64_t *)v2);
    if (v4 < 1 != (v4 & -v4) < 0) {
        // 0x100003a90
        _printf("Invalid choice. Please choose a number between 1 and 3.\n");
        // 0x100003bac
        return function_100003a2c();
    }
    int32_t v5 = v4 - 3; // 0x100003a80
    if (v5 != 0 && v5 < 0 == (2 - v4 & v4) < 0) {
        // 0x100003a90
        _printf("Invalid choice. Please choose a number between 1 and 3.\n");
        // 0x100003bac
        return function_100003a2c();
    }
    int32_t * v6 = (int32_t *)v1; // 0x100003a40
    int32_t v7 = *(int32_t *)(24 * (0x100000000 * v1 >> 32) + (int64_t)&g1 + (int64_t)(4 * v4 - 4)); // 0x100003ad4
    int32_t * v8 = (int32_t *)(24 * (int64_t)v7 + (int64_t)&g1 + 12); // 0x100003ae8
    if (*v8 != 0) {
        int32_t result = _printf("Congratulations! You've killed the Wumpus!\n"); // 0x100003b04
        *v6 = 1;
        // 0x100003bac
        return result;
    }
    int32_t v9 = _rand(); // 0x100003b18
    if (v9 == 4 * v9 / 4 || *v8 == 0) {
        int32_t result2 = _printf("You missed! The Wumpus is still asleep.\n"); // 0x100003b90
        *(int32_t *)v2 = (int32_t)v2 - 1;
        // 0x100003bac
        return result2;
    }
    int32_t result3 = _printf("The Wumpus has woken up and eaten you!\n"); // 0x100003b70
    *v6 = 1;
    // 0x100003bac
    return result3;
}

// Address range: 0x100003bb8 - 0x100003d00
int64_t entry_point(void) {
    // 0x100003bb8
    _srand(_time(NULL));
    function_100003678();
    int32_t v1 = 5; // bp-28, 0x100003be4
    _printf("Welcome to Hunt the Wumpus!\n");
    while (true) {
        // 0x100003c10
        int64_t v2; // 0x100003bb8
        int64_t v3 = v2;
        function_100003840();
        _printf("Choose your action:\n");
        _printf("1. Move to an adjacent room\n");
        _printf("2. Shoot into an adjacent room\n");
        _printf("Enter your choice (1 or 2): ");
        _scanf("%d", (int64_t *)v3);
        int32_t v4; // 0x100003bb8
        int64_t v5; // 0x100003bb8
        switch (v4) {
            case 1: {
                // 0x100003c8c
                function_100003978();
                v5 = v3;
                // break -> 0x100003cec
                break;
            }
            case 2: {
                // 0x100003c98
                if (v1 < 1) {
                    // break -> 0x100003cf0
                    break;
                }
                // 0x100003cac
                function_100003a2c();
                v5 = &v1;
                // break -> 0x100003cec
                break;
            }
            default: {
                // 0x100003cdc
                _printf("Invalid choice. Please choose 1 or 2.\n");
                v5 = v3;
                // break -> 0x100003cec
                break;
            }
        }
        // 0x100003cec
        v2 = v5;
    }
}

// Address range: 0x100003d00 - 0x100003d0c
int32_t function_100003d00(char * format, ...) {
    // 0x100003d00
    return _printf(format);
}

// Address range: 0x100003d0c - 0x100003d18
int32_t function_100003d0c(void) {
    // 0x100003d0c
    return _rand();
}

// Address range: 0x100003d18 - 0x100003d24
int32_t function_100003d18(char * format, ...) {
    // 0x100003d18
    return _scanf(format);
}

// Address range: 0x100003d24 - 0x100003d30
void function_100003d24(int32_t seed) {
    // 0x100003d24
    _srand(seed);
}

// Address range: 0x100003d30 - 0x100003d3c
int32_t function_100003d30(int32_t * timer) {
    // 0x100003d30
    return _time(timer);
}

// --------------------- Meta-Information ---------------------

// Detected functions: 10

