//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdint.h>

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

// ------------------- Function Prototypes --------------------

int64_t entry_point(void);
int64_t function_100003adc(void);
int64_t function_100003cbc(int64_t * a1, int64_t * a2, int64_t a3);
int64_t function_100003ebc(int64_t a1, int64_t a2, int64_t a3, int64_t a4, char * a5);
int64_t function_100003ec8(int64_t a1);
int32_t function_100003ed4(struct _IO_FILE * stream, char * format, ...);
int64_t * function_100003ee0(int64_t * dest, int64_t * src, int32_t n);
int32_t function_100003eec(char * format, ...);
int32_t function_100003ef8(char * s, char * format, ...);

// ------- Dynamically Linked Functions Without Header --------

int64_t ___snprintf_chk(int64_t a1, int64_t a2, int64_t a3, int64_t a4, char * a5);
int64_t ___stack_chk_fail(int64_t a1);
int32_t _fprintf(struct _IO_FILE * a1, char * a2, ...);
int64_t * _memcpy(int64_t * a1, int64_t * a2, int32_t a3);
int32_t _printf(char * a1, ...);
int32_t _sscanf(char * a1, char * a2, ...);

// ------------------------ Functions -------------------------

// Address range: 0x100003adc - 0x100003cbc
int64_t function_100003adc(void) {
    // 0x100003adc
    int32_t v1; // 0x100003adc
    int32_t v2 = v1;
    int32_t v3 = v1;
    int32_t v4 = v1;
    int32_t v5 = v1;
    int32_t v6 = v1;
    int64_t v7; // 0x100003adc
    if (_sscanf((char *)v7, "%d.%d.%d.%d/%d", (int64_t *)v7, (int64_t *)v7, (int64_t *)v7, (int64_t *)v7, (int64_t *)v7) != 5 || v2 < 1 != (v2 & -v2) < 0) {
        // 0x100003ca8
        return 0;
    }
    int32_t v8 = v2 - 32; // 0x100003b68
    if (v8 != 0 == v8 < 0 == (31 - v2 & v2) < 0 || v6 < 0) {
        // 0x100003ca8
        return 0;
    }
    int32_t v9 = v6 - 255; // 0x100003b90
    if (v5 < 0 || v9 != 0 == v9 < 0 == (254 - v6 & v6) < 0) {
        // 0x100003ca8
        return 0;
    }
    int32_t v10 = v5 - 255; // 0x100003bb8
    if (v4 < 0 || v10 != 0 == v10 < 0 == (254 - v5 & v5) < 0) {
        // 0x100003ca8
        return 0;
    }
    int32_t v11 = v4 - 255; // 0x100003be0
    if (v3 < 0 || v11 != 0 == v11 < 0 == (254 - v4 & v4) < 0) {
        // 0x100003ca8
        return 0;
    }
    int32_t v12 = v3 - 255; // 0x100003c08
    int64_t result = 0; // 0x100003c10
    if (v12 == 0 || v12 < 0 != (254 - v3 & v3) < 0) {
        // 0x100003c2c
        *(int32_t *)v7 = 256 * v4 + v3 + 0x10000 * v5 + 0x1000000 * v6 & -1 << 32 - v2;
        result = 1;
    }
    // 0x100003ca8
    return result;
}

// Address range: 0x100003cbc - 0x100003d90
int64_t function_100003cbc(int64_t * a1, int64_t * a2, int64_t a3) {
    // 0x100003cbc
    return ___snprintf_chk((int64_t)a2, a3, 0, -1, "%u.%u.%u.%u/%u");
}

// Address range: 0x100003d90 - 0x100003ebc
int64_t entry_point(void) {
    // 0x100003d90
    int64_t v1; // bp-72, 0x100003d90
    _memcpy(&v1, (int64_t *)"\"?", 48);
    int32_t v2 = 0; // 0x100003e7c
    int64_t v3 = 48; // 0x100003d90
    int64_t v4; // bp-104, 0x100003d90
    int64_t v5; // bp-132, 0x100003d90
    int32_t v6; // 0x100003d90
    int64_t v7; // 0x100003e4c
    int32_t v8; // 0x100003e6c
    int32_t v9; // 0x100003e3c
    int64_t v10; // 0x100003d90
    if (function_100003adc() % 2 == 0) {
        // 0x100003e44
        v7 = *(int64_t *)*(int64_t *)0x100004018;
        v8 = _fprintf((struct _IO_FILE *)v7, "%s: invalid CIDR\n", (char *)v3);
        v10 = v3;
        v6 = v8;
    } else {
        // 0x100003e04
        function_100003cbc(&v5, &v4, 32);
        v9 = _printf("%-18s -> %s\n", &v4, (char *)32);
        v10 = 32;
        v6 = v9;
    }
    // 0x100003e74
    v2++;
    v3 = v10;
    while (v2 != 6) {
        // 0x100003de8
        if (function_100003adc() % 2 == 0) {
            // 0x100003e44
            v7 = *(int64_t *)*(int64_t *)0x100004018;
            v8 = _fprintf((struct _IO_FILE *)v7, "%s: invalid CIDR\n", (char *)v3);
            v10 = v3;
            v6 = v8;
        } else {
            // 0x100003e04
            function_100003cbc(&v5, &v4, 32);
            v9 = _printf("%-18s -> %s\n", &v4, (char *)32);
            v10 = 32;
            v6 = v9;
        }
        // 0x100003e74
        v2++;
        v3 = v10;
    }
    int64_t v11 = *(int64_t *)0x100004010; // 0x100003e90
    if (*(int64_t *)v11 != *(int64_t *)*(int64_t *)0x100004010) {
        // 0x100003ea8
        ___stack_chk_fail((int64_t)v6);
    }
    // 0x100003eac
    return 0;
}

// Address range: 0x100003ebc - 0x100003ec8
int64_t function_100003ebc(int64_t a1, int64_t a2, int64_t a3, int64_t a4, char * a5) {
    // 0x100003ebc
    return ___snprintf_chk(a1, a2, a3, a4, a5);
}

// Address range: 0x100003ec8 - 0x100003ed4
int64_t function_100003ec8(int64_t a1) {
    // 0x100003ec8
    return ___stack_chk_fail(a1);
}

// Address range: 0x100003ed4 - 0x100003ee0
int32_t function_100003ed4(struct _IO_FILE * stream, char * format, ...) {
    // 0x100003ed4
    return _fprintf(stream, format);
}

// Address range: 0x100003ee0 - 0x100003eec
int64_t * function_100003ee0(int64_t * dest, int64_t * src, int32_t n) {
    // 0x100003ee0
    return _memcpy(dest, src, n);
}

// Address range: 0x100003eec - 0x100003ef8
int32_t function_100003eec(char * format, ...) {
    // 0x100003eec
    return _printf(format);
}

// Address range: 0x100003ef8 - 0x100003f04
int32_t function_100003ef8(char * s, char * format, ...) {
    // 0x100003ef8
    return _sscanf(s, format);
}

// --------------------- Meta-Information ---------------------

// Detected functions: 9

